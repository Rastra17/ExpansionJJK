plugins {
  id 'java'
  id 'fabric-loom' version '1.10.5'
  id 'maven-publish'
}

group = project.maven_group
version = project.mod_version
archivesBaseName = project.archives_base_name

java {
  sourceCompatibility = JavaVersion.VERSION_17
  targetCompatibility = JavaVersion.VERSION_17
  withSourcesJar()
}

repositories {
  mavenCentral()
  maven { url = 'https://maven.fabricmc.net/' }
}

dependencies {
  minecraft "com.mojang:minecraft:${project.minecraft_version}"
  mappings  "net.fabricmc:yarn:1.21.1+build.3:v2"
  modImplementation "net.fabricmc:fabric-loader:${project.loader_version}"
  modImplementation "net.fabricmc.fabric-api:fabric-api:${project.fabric_version}"
}

processResources {
  inputs.property 'version', project.version
  filesMatching('fabric.mod.json') { expand version: project.version }
}

tasks.withType(JavaCompile).configureEach {
  options.encoding = 'UTF-8'
  options.release = 17
}

loom {
  runs {
    client {
      client()
      runDir = 'run'
    }
    server {
      server()
      runDir = 'run_server'
    }
  }
}